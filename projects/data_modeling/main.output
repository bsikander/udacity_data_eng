➜  data_modeling git:(master) ✗ python main.py --refresh --run-test
2019-11-24 08:30:16 [info     ] running with test...           [__main__] lineno=78
2019-11-24 08:30:16 [info     ] running with a fresh database  [__main__] lineno=80
2019-11-24 08:30:16 [info     ] DROP DATABASE IF EXISTS sparkifydb [db] lineno=41
2019-11-24 08:30:16 [info     ] CREATE DATABASE sparkifydb WITH ENCODING 'utf8' [db] lineno=41
2019-11-24 08:30:16 [info     ] DROP TABLE IF EXISTS songplays [db] lineno=41
2019-11-24 08:30:16 [info     ] DROP TABLE IF EXISTS users     [db] lineno=41
2019-11-24 08:30:17 [info     ] DROP TABLE IF EXISTS songs     [db] lineno=41
2019-11-24 08:30:17 [info     ] DROP TABLE IF EXISTS artists   [db] lineno=41
2019-11-24 08:30:17 [info     ] DROP TABLE IF EXISTS time      [db] lineno=41
2019-11-24 08:30:17 [info     ]
CREATE TABLE songplays (
    songplay_id int,
    start_time timestamp,
    user_id int,
    song_id text,
    artist_id text,
    session_id int,
    level text,
    location text,
    user_agent text
);
 [db] lineno=41
2019-11-24 08:30:17 [info     ]
CREATE TABLE users (
    user_id int,
    first_name text,
    last_name text,
    gender text,
    level text
);
 [db] lineno=41
2019-11-24 08:30:17 [info     ]
CREATE TABLE songs (
    song_id text,
    title text,
    artist_id text,
    year int,
    duration float
);
 [db] lineno=41
2019-11-24 08:30:17 [info     ]
CREATE TABLE artists (
    artist_id text,
    name text,
    location text,
    latitude float,
    longitute float
);
 [db] lineno=41
2019-11-24 08:30:17 [info     ]
CREATE TABLE time (
    start_time timestamp,
    hour int,
    day int,
    week int,
    month int,
    year int,
    weekday int
);
 [db] lineno=41
2019-11-24 08:30:17 [info     ] Processing files in data/song_data... [etl] lineno=143
2019-11-24 08:30:17 [info     ] 60 files found in data/song_data [etl] lineno=26
2019-11-24 08:30:17 [info     ] Loading data from each file in {filepath} to one dataframe... [etl] lineno=146
/Users/pwen/.pyenv/versions/3.6.7/lib/python3.6/site-packages/pandas/core/frame.py:7138: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version
of pandas will change to not sort by default.

To accept the future behavior, pass 'sort=False'.

To retain the current behavior and silence the warning, pass 'sort=True'.

  sort=sort,
/Users/pwen/udacity_data_eng/projects/data_modeling/etl.py:155: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dfs.drop_duplicates(subset="song_id", inplace=True)
2019-11-24 08:30:17 [info     ] Copying into table songs...    [db.postgres] lineno=58
2019-11-24 08:30:17 [info     ] 60 rows uploaded to songs      [db.postgres] lineno=69
2019-11-24 08:30:17 [info     ] Copying into table artists...  [db.postgres] lineno=58
2019-11-24 08:30:17 [info     ] 58 rows uploaded to artists    [db.postgres] lineno=69
2019-11-24 08:30:17 [info     ] Processing files in data/log_data... [etl] lineno=75
2019-11-24 08:30:17 [info     ] 30 files found in data/log_data [etl] lineno=26
2019-11-24 08:30:17 [info     ] Loading data from each file in {filepath} to one dataframe... [etl] lineno=78
2019-11-24 08:30:17 [info     ] Copying into table users...    [db.postgres] lineno=58
2019-11-24 08:30:17 [info     ] 134 rows uploaded to users     [db.postgres] lineno=69
2019-11-24 08:30:17 [info     ] Copying into table time...     [db.postgres] lineno=58
2019-11-24 08:30:17 [info     ] 6820 rows uploaded to time     [db.postgres] lineno=69
2019-11-24 08:30:17 [info     ] SELECT artist_id, name FROM artists; [db] lineno=41
2019-11-24 08:30:17 [info     ] SELECT song_id, title FROM songs; [db] lineno=41
2019-11-24 08:30:18 [info     ] Copying into table songplays... [db.postgres] lineno=58
2019-11-24 08:30:18 [info     ] 6820 rows uploaded to songplays [db.postgres] lineno=69
2019-11-24 08:30:18 [info     ] Running basic set of tests...  [__main__] lineno=28
2019-11-24 08:30:18 [info     ] SELECT * from songs LIMIT 5    [db] lineno=41
2019-11-24 08:30:18 [info     ] ('SONHOTT12A8C13493C', 'Something Girls', 'AR7G5I41187FB4CE6C', 1982, 233.40363) [__main__] lineno=42
2019-11-24 08:30:18 [info     ] ('SOIAZJW12AB01853F1', 'Pink World', 'AR8ZCNI1187B9A069B', 1984, 269.81832) [__main__] lineno=42
2019-11-24 08:30:18 [info     ] ('SOFSOCN12A8C143F5D', 'Face the Ashes', 'ARXR32B1187FB57099', 2007, 209.60608) [__main__] lineno=42
2019-11-24 08:30:18 [info     ] ('SOHKNRJ12A6701D1F8', 'Drop of Rain', 'AR10USD1187B99F3F1', 0, 189.57016) [__main__] lineno=42
2019-11-24 08:30:18 [info     ] ('SOCIWDW12A8C13D406', 'Soul Deep', 'ARMJAGH1187FB546F3', 1969, 148.03546) [__main__] lineno=42
2019-11-24 08:30:18 [info     ] SELECT * from artists LIMIT 5  [db] lineno=41
2019-11-24 08:30:18 [info     ] ('AR7G5I41187FB4CE6C', 'Adam Ant', 'London, England', None, None) [__main__] lineno=42
2019-11-24 08:30:18 [info     ] ('AR8ZCNI1187B9A069B', 'Planet P Project', None, None, None) [__main__] lineno=42
2019-11-24 08:30:18 [info     ] ('ARXR32B1187FB57099', 'Gob', None, None, None) [__main__] lineno=42
2019-11-24 08:30:18 [info     ] ('AR10USD1187B99F3F1', 'Tweeterfriendly Music', 'Burlington, Ontario, Canada', None, None) [__main__] lineno=42
2019-11-24 08:30:18 [info     ] ('ARMJAGH1187FB546F3', 'The Box Tops', 'Memphis, TN', 35.14968, -90.04892) [__main__] lineno=42
2019-11-24 08:30:18 [info     ] SELECT * from users LIMIT 5    [db] lineno=41
2019-11-24 08:30:18 [info     ] (69, 'Anabelle', 'Simpson', 'F', 'free') [__main__] lineno=42
2019-11-24 08:30:18 [info     ] (32, 'Lily', 'Burns', 'F', 'free') [__main__] lineno=42
2019-11-24 08:30:18 [info     ] (75, 'Joseph', 'Gutierrez', 'M', 'free') [__main__] lineno=42
2019-11-24 08:30:18 [info     ] (92, 'Ryann', 'Smith', 'F', 'free') [__main__] lineno=42
2019-11-24 08:30:18 [info     ] (49, 'Chloe', 'Cuevas', 'F', 'free') [__main__] lineno=42
2019-11-24 08:30:18 [info     ] SELECT * from time LIMIT 5     [db] lineno=41
2019-11-24 08:30:18 [info     ] (datetime.datetime(2018, 11, 11, 2, 33, 56, 796000), 2, 11, 45, 11, 2018, 6) [__main__] lineno=42
2019-11-24 08:30:18 [info     ] (datetime.datetime(2018, 11, 11, 2, 36, 10, 796000), 2, 11, 45, 11, 2018, 6) [__main__] lineno=42
2019-11-24 08:30:18 [info     ] (datetime.datetime(2018, 11, 11, 2, 40, 34, 796000), 2, 11, 45, 11, 2018, 6) [__main__] lineno=42
2019-11-24 08:30:18 [info     ] (datetime.datetime(2018, 11, 11, 4, 36, 13, 796000), 4, 11, 45, 11, 2018, 6) [__main__] lineno=42
2019-11-24 08:30:18 [info     ] (datetime.datetime(2018, 11, 11, 4, 36, 46, 796000), 4, 11, 45, 11, 2018, 6) [__main__] lineno=42
2019-11-24 08:30:18 [info     ] SELECT * from songplays LIMIT 5 [db] lineno=41
2019-11-24 08:30:18 [info     ] (None, datetime.datetime(2018, 11, 11, 2, 33, 56, 796000), 69, None, None, 455, 'free', 'Philadelphia-Camden-Wilmington, PA-NJ-DE-MD', '"""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36"""') [__main__] lineno=42
2019-11-24 08:30:18 [info     ] (None, datetime.datetime(2018, 11, 11, 2, 36, 10, 796000), 69, None, None, 455, 'free', 'Philadelphia-Camden-Wilmington, PA-NJ-DE-MD', '"""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36"""') [__main__] lineno=42
2019-11-24 08:30:18 [info     ] (None, datetime.datetime(2018, 11, 11, 2, 40, 34, 796000), 69, None, None, 455, 'free', 'Philadelphia-Camden-Wilmington, PA-NJ-DE-MD', '"""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36"""') [__main__] lineno=42
2019-11-24 08:30:18 [info     ] (None, datetime.datetime(2018, 11, 11, 4, 36, 13, 796000), 32, None, None, 456, 'free', 'New York-Newark-Jersey City, NY-NJ-PA', '"""Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36"""') [__main__] lineno=42
2019-11-24 08:30:18 [info     ] (None, datetime.datetime(2018, 11, 11, 4, 36, 46, 796000), 75, None, None, 284, 'free', 'Columbia, SC', '"""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.75.14 (KHTML, like Gecko) Version/7.0.3 Safari/537.75.14"""') [__main__] lineno=42
2019-11-24 08:30:18 [info     ] Running test on fct table songplays... [__main__] lineno=44
2019-11-24 08:30:18 [info     ] SELECT * FROM songplays WHERE song_id is not null AND artist_id is not null [db] lineno=41
2019-11-24 08:30:18 [info     ] (None, datetime.datetime(2018, 11, 21, 21, 56, 47, 796000), 15, 'SOZCTXZ12AB0182364', 'AR5KOSW1187FB35FF4', 818, 'paid', 'Chicago-Naperville-Elgin, IL-IN-WI', '"""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/36.0.1985.125 Chrome/36.0.1985.125 Safari/537.36"""') [__main__] lineno=51
